-- Create Tables



-- Drop labels table if exists;
-- Create labels table if not exists;
DROP TABLE IF EXISTS labels;

CREATE TABLE IF NOT EXISTS labels (
    label_name  text PRIMARY KEY ,
    parent_name text references labels(label_name),
    children    varchar[]
);
	

-- Drop users table if exists;
-- Create users table if not exists;
DROP TABLE IF EXISTS users;

CREATE TABLE IF NOT EXISTS users (
    user_id				SERIAL	PRIMARY KEY ,
	user_name			text,
    user_role			text,
	on_board_date 		timestamp

);


-- Drop batches table if exists;
-- Create batches table if not exists;
DROP TABLE IF EXISTS images_batches;

CREATE TABLE IF NOT EXISTS images_batches (
    batch_id			SERIAL	PRIMARY KEY ,
	user_id				int references users(user_id),
	on_board_date 		timestamp
);


-- Drop places table if exists;
-- Create places table if not exists;
DROP TABLE IF EXISTS places;

CREATE TABLE IF NOT EXISTS places (
    place_id		int	PRIMARY KEY ,
    licence			text,
    postcode    	int,
	neighbourhood	text,
	city			text,
	country			text,
	lon				float,
	lat 			float,
	geometry 		point,
	time_added		timestamp
);
	
	
-- Drop images table if exists;
-- Create images table if not exists;
DROP TABLE IF EXISTS images;

CREATE TABLE IF NOT EXISTS images (
    image_id			SERIAL	PRIMARY KEY ,
    image_object_key	text,
	bucket_name			text,
	parent_labels		text,
	label_name			text,
	batch_id			int references images_batches(batch_id),
	submission_time 	timestamp,
	user_id				int references users(user_id),
	place_id			int references places(place_id),
	geometry 			point,
	image_index			int,
	embeddings			float[]
);



	
	