-- Queries for customers from Web UI


-- Select 9 most recent image batches 
SELECT (SELECT label_name FROM images WHERE batch_id in (ib.batch_id) LIMIT 1 ) AS label_name , ib.submitted_count, ib.on_board_date, pl.city, pl.neighbourhood, pl.geometry, (SELECT full_hadoop_path FROM images WHERE batch_id in (ib.batch_id) LIMIT 1 ) AS sample_image
FROM images_batches AS ib
INNER JOIN places as pl
ON ib.place_id = pl.place_id
WHERE ib.submitted_count > 0
ORDER BY ib.on_board_date  DESC
LIMIT 9;



select * from images limit 10; 

image_thu

-- Select 24 labels order by label_name
SELECT * , (SELECT full_hadoop_path FROM images WHERE label_name in (l.label_name) LIMIT 1 ) AS sample_image
FROM labels AS l
WHERE l.image_count > 0
ORDER BY l.label_name  
LIMIT 24;
	

-- Select 24 labels order by label_name and also filter by parent's Name
SELECT * , (SELECT full_hadoop_path FROM images WHERE label_name in (l.label_name) LIMIT 1 ) AS sample_image
FROM labels AS l
WHERE l.image_count > 0
AND l.parent_name = 'Food'
ORDER BY l.label_name  
LIMIT 24;
	
